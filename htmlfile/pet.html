<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>寵物系統 - GameSpace</title>
  <style>
    :root {
      --bg: #f8f9fa;
      --surface: #ffffff;
      --text: #212529;
      --muted: #6c757d;
      --line: #dee2e6;
      --accent: #007bff;
      --accent-hover: #0056b3;
      --success: #28a745;
      --warning: #ffc107;
      --danger: #dc3545;
      --info: #17a2b8;
      --shadow: 0 2px 4px rgba(0,0,0,0.1);
      --shadow-lg: 0 4px 8px rgba(0,0,0,0.15);
      --radius: 8px;
      --radius-lg: 12px;
      --blur: 8px;
      --spacing: 16px;
      --spacing-sm: 8px;
      --spacing-lg: 24px;
    }

    body.dark {
      --bg: #1a1a1a;
      --surface: #2d2d2d;
      --text: #ffffff;
      --muted: #adb5bd;
      --line: #495057;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
    
    .container { max-width: 1200px; margin: 0 auto; padding: var(--spacing); }
    
    .header { background: var(--surface); border-radius: var(--radius-lg); padding: var(--spacing-lg); margin-bottom: var(--spacing-lg); box-shadow: var(--shadow); }
    .header h1 { font-size: 2rem; margin-bottom: var(--spacing-sm); }
    .header p { color: var(--muted); }
    
    .nav { display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-lg); }
    .nav a { padding: var(--spacing-sm) var(--spacing); background: var(--surface); border-radius: var(--radius); text-decoration: none; color: var(--text); box-shadow: var(--shadow); transition: all 0.2s; }
    .nav a:hover { background: var(--accent); color: white; }
    
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--spacing-lg); }
    .card { background: var(--surface); border-radius: var(--radius-lg); padding: var(--spacing-lg); box-shadow: var(--shadow); }
    .card h3 { margin-bottom: var(--spacing); color: var(--accent); }
    
    .pet-display { text-align: center; margin-bottom: var(--spacing-lg); }
    .pet-canvas { border: 3px solid var(--line); border-radius: var(--radius-lg); background: linear-gradient(135deg, #87CEEB, #98FB98); margin: 0 auto; display: block; }
    .pet-info { margin-top: var(--spacing); }
    .pet-name { font-size: 1.5rem; font-weight: bold; color: var(--accent); margin-bottom: var(--spacing-sm); }
    
    .attributes { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-sm); margin-bottom: var(--spacing-lg); }
    .attribute { background: var(--surface); border-radius: var(--radius); padding: var(--spacing-sm); box-shadow: var(--shadow); }
    .attribute-name { font-weight: bold; margin-bottom: var(--spacing-sm); color: var(--accent); }
    .attribute-bar { width: 100%; height: 20px; background: var(--line); border-radius: 10px; overflow: hidden; }
    .attribute-fill { height: 100%; transition: width 0.3s ease; }
    .attribute-fill.hunger { background: linear-gradient(90deg, var(--danger), var(--warning)); }
    .attribute-fill.mood { background: linear-gradient(90deg, var(--danger), var(--success)); }
    .attribute-fill.energy { background: linear-gradient(90deg, var(--danger), var(--info)); }
    .attribute-fill.clean { background: linear-gradient(90deg, var(--danger), var(--accent)); }
    .attribute-fill.health { background: linear-gradient(90deg, var(--danger), var(--success)); }
    .attribute-value { text-align: center; margin-top: var(--spacing-sm); font-weight: bold; }
    
    .actions { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: var(--spacing-sm); margin-bottom: var(--spacing-lg); }
    .action-btn { padding: var(--spacing-sm); background: var(--accent); color: white; border: none; border-radius: var(--radius); cursor: pointer; transition: all 0.2s; font-size: 0.9rem; }
    .action-btn:hover { background: var(--accent-hover); transform: translateY(-2px); }
    .action-btn:disabled { background: var(--muted); cursor: not-allowed; transform: none; }
    
    .customization { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-sm); }
    .customization-item { background: var(--surface); border-radius: var(--radius); padding: var(--spacing-sm); box-shadow: var(--shadow); text-align: center; }
    .customization-item img { width: 60px; height: 60px; border-radius: var(--radius); margin-bottom: var(--spacing-sm); }
    .customization-item h4 { margin-bottom: var(--spacing-sm); }
    .customization-item .price { color: var(--accent); font-weight: bold; margin-bottom: var(--spacing-sm); }
    
    .btn { padding: var(--spacing-sm) var(--spacing); background: var(--accent); color: white; border: none; border-radius: var(--radius); cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-block; }
    .btn:hover { background: var(--accent-hover); }
    .btn.success { background: var(--success); }
    .btn.warning { background: var(--warning); color: var(--text); }
    
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
    .modal.show { display: flex; align-items: center; justify-content: center; }
    .modal-content { background: var(--surface); border-radius: var(--radius-lg); padding: var(--spacing-lg); max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing); }
    .modal-header h3 { margin: 0; }
    .close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--muted); }
    
    .log { background: var(--surface); border-radius: var(--radius); padding: var(--spacing-sm); max-height: 200px; overflow-y: auto; border: 1px solid var(--line); }
    .log-item { padding: var(--spacing-sm); border-bottom: 1px solid var(--line); font-size: 0.9rem; }
    .log-item:last-child { border-bottom: none; }
    .log-item.success { color: var(--success); }
    .log-item.warning { color: var(--warning); }
    .log-item.error { color: var(--danger); }
    
    @media (max-width: 768px) {
      .container { padding: var(--spacing-sm); }
      .grid { grid-template-columns: 1fr; }
      .attributes { grid-template-columns: 1fr; }
      .actions { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🐾 寵物系統</h1>
      <p>照顧您的可愛寵物，與它一起成長！</p>
    </div>
    
    <nav class="nav">
      <a href="index.html">🏠 首頁</a>
      <a href="wallet.html">💰 會員錢包</a>
      <a href="signin.html">📅 簽到系統</a>
      <a href="pet.html">🐾 寵物系統</a>
      <a href="minigame.html">🎮 小遊戲</a>
    </nav>
    
    <div class="pet-display">
      <canvas id="petCanvas" class="pet-canvas" width="300" height="300"></canvas>
      <div class="pet-info">
        <div class="pet-name" id="petName">小史萊姆</div>
        <div style="color: var(--muted);">等級 <span id="petLevel">5</span> | 經驗 <span id="petExp">120</span>/<span id="petExpMax">200</span></div>
      </div>
    </div>
    
    <div class="attributes">
      <div class="attribute">
        <div class="attribute-name">🍎 飢餓度</div>
        <div class="attribute-bar">
          <div class="attribute-fill hunger" id="hungerBar" style="width: 75%;"></div>
        </div>
        <div class="attribute-value" id="hungerValue">75</div>
      </div>
      <div class="attribute">
        <div class="attribute-name">😊 心情</div>
        <div class="attribute-bar">
          <div class="attribute-fill mood" id="moodBar" style="width: 85%;"></div>
        </div>
        <div class="attribute-value" id="moodValue">85</div>
      </div>
      <div class="attribute">
        <div class="attribute-name">⚡ 活力</div>
        <div class="attribute-bar">
          <div class="attribute-fill energy" id="energyBar" style="width: 60%;"></div>
        </div>
        <div class="attribute-value" id="energyValue">60</div>
      </div>
      <div class="attribute">
        <div class="attribute-name">🧼 清潔度</div>
        <div class="attribute-bar">
          <div class="attribute-fill clean" id="cleanBar" style="width: 90%;"></div>
        </div>
        <div class="attribute-value" id="cleanValue">90</div>
      </div>
      <div class="attribute">
        <div class="attribute-name">❤️ 健康度</div>
        <div class="attribute-bar">
          <div class="attribute-fill health" id="healthBar" style="width: 95%;"></div>
        </div>
        <div class="attribute-value" id="healthValue">95</div>
      </div>
    </div>
    
    <div class="actions">
      <button class="action-btn" onclick="feedPet()">🍎 餵食</button>
      <button class="action-btn" onclick="playWithPet()">🎾 玩耍</button>
      <button class="action-btn" onclick="bathePet()">🛁 洗澡</button>
      <button class="action-btn" onclick="sleepPet()">😴 哄睡</button>
      <button class="action-btn" onclick="renamePet()">✏️ 改名</button>
      <button class="action-btn" onclick="changeSkin()">🎨 換膚</button>
    </div>
    
    <div class="grid">
      <div class="card">
        <h3>🎨 寵物皮膚</h3>
        <div class="customization">
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: #f6d84a; border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>經典黃</h4>
            <div class="price">免費</div>
            <button class="btn" onclick="selectSkin('classic')">選擇</button>
          </div>
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: #ff6b6b; border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>熱情紅</h4>
            <div class="price">100點</div>
            <button class="btn" onclick="selectSkin('red')">選擇</button>
          </div>
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: #4ecdc4; border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>清新藍</h4>
            <div class="price">150點</div>
            <button class="btn" onclick="selectSkin('blue')">選擇</button>
          </div>
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: #45b7d1; border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>夢幻紫</h4>
            <div class="price">200點</div>
            <button class="btn" onclick="selectSkin('purple')">選擇</button>
          </div>
        </div>
      </div>
      
      <div class="card">
        <h3>🖼️ 背景主題</h3>
        <div class="customization">
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #87CEEB, #98FB98); border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>草原</h4>
            <div class="price">免費</div>
            <button class="btn" onclick="selectBackground('grassland')">選擇</button>
          </div>
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #ff9a9e, #fecfef); border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>櫻花</h4>
            <div class="price">150點</div>
            <button class="btn" onclick="selectBackground('sakura')">選擇</button>
          </div>
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>星空</h4>
            <div class="price">200點</div>
            <button class="btn" onclick="selectBackground('starry')">選擇</button>
          </div>
          <div class="customization-item">
            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #f093fb, #f5576c); border-radius: var(--radius); margin: 0 auto var(--spacing-sm);"></div>
            <h4>彩虹</h4>
            <div class="price">300點</div>
            <button class="btn" onclick="selectBackground('rainbow')">選擇</button>
          </div>
        </div>
      </div>
      
      <div class="card">
        <h3>📝 互動日誌</h3>
        <div class="log" id="petLog">
          <div class="log-item success">🍎 餵食成功！飢餓度 +10</div>
          <div class="log-item success">🎾 玩耍成功！心情 +15</div>
          <div class="log-item success">🛁 洗澡成功！清潔度 +20</div>
          <div class="log-item success">😴 哄睡成功！活力 +25</div>
          <div class="log-item">📅 每日自動恢復：健康度 +5</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 改名模態框 -->
  <div id="renameModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>✏️ 修改寵物名字</h3>
        <button class="close" onclick="closeRenameModal()">&times;</button>
      </div>
      <div style="margin-bottom: var(--spacing);">
        <input type="text" id="newPetName" placeholder="輸入新的寵物名字" style="width: 100%; padding: var(--spacing-sm); border-radius: var(--radius); border: 1px solid var(--line);">
      </div>
      <div style="text-align: right;">
        <button class="btn" onclick="confirmRename()">確認修改</button>
      </div>
    </div>
  </div>
  
  <script>
    // 寵物數據
    let pet = {
      name: '小史萊姆',
      level: 5,
      exp: 120,
      expMax: 200,
      hunger: 75,
      mood: 85,
      energy: 60,
      clean: 90,
      health: 95,
      skin: 'classic',
      background: 'grassland'
    };
    
    // Canvas 繪製
    const canvas = document.getElementById('petCanvas');
    const ctx = canvas.getContext('2d');
    let animationFrame = 0;
    
    function drawPet() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // 繪製背景
      const backgrounds = {
        'grassland': ['#87CEEB', '#98FB98'],
        'sakura': ['#ff9a9e', '#fecfef'],
        'starry': ['#667eea', '#764ba2'],
        'rainbow': ['#f093fb', '#f5576c']
      };
      
      const bgColors = backgrounds[pet.background] || backgrounds['grassland'];
      const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
      gradient.addColorStop(0, bgColors[0]);
      gradient.addColorStop(1, bgColors[1]);
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // 繪製地面
      ctx.fillStyle = '#90EE90';
      ctx.fillRect(0, canvas.height - 40, canvas.width, 40);
      
      // 繪製史萊姆
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2 + 20;
      const size = 80;
      
      // 史萊姆顏色
      const skinColors = {
        'classic': '#f6d84a',
        'red': '#ff6b6b',
        'blue': '#4ecdc4',
        'purple': '#45b7d1'
      };
      
      ctx.fillStyle = skinColors[pet.skin] || skinColors['classic'];
      
      // 史萊姆身體（帶動畫）
      const bounce = Math.sin(animationFrame * 0.1) * 3;
      ctx.beginPath();
      ctx.ellipse(centerX, centerY + bounce, size, size * 0.8, 0, 0, 2 * Math.PI);
      ctx.fill();
      
      // 史萊姆高光
      ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
      ctx.beginPath();
      ctx.ellipse(centerX - 20, centerY - 20 + bounce, 20, 15, 0, 0, 2 * Math.PI);
      ctx.fill();
      
      // 眼睛
      const eyeBlink = Math.sin(animationFrame * 0.05) > 0.8 ? 0 : 8;
      ctx.fillStyle = '#000';
      ctx.beginPath();
      ctx.ellipse(centerX - 15, centerY - 10 + bounce, 6, eyeBlink, 0, 0, 2 * Math.PI);
      ctx.fill();
      ctx.beginPath();
      ctx.ellipse(centerX + 15, centerY - 10 + bounce, 6, eyeBlink, 0, 0, 2 * Math.PI);
      ctx.fill();
      
      // 嘴巴（根據心情變化）
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 2;
      if (pet.mood > 70) {
        // 開心
        ctx.beginPath();
        ctx.arc(centerX, centerY + 10 + bounce, 15, 0, Math.PI);
        ctx.stroke();
      } else if (pet.mood > 40) {
        // 普通
        ctx.beginPath();
        ctx.moveTo(centerX - 10, centerY + 10 + bounce);
        ctx.lineTo(centerX + 10, centerY + 10 + bounce);
        ctx.stroke();
      } else {
        // 不開心
        ctx.beginPath();
        ctx.arc(centerX, centerY + 20 + bounce, 15, Math.PI, 2 * Math.PI);
        ctx.stroke();
      }
      
      // 狀態效果
      if (pet.clean < 50) {
        // 髒污效果
        ctx.fillStyle = 'rgba(139, 69, 19, 0.3)';
        ctx.beginPath();
        ctx.ellipse(centerX - 10, centerY + 5 + bounce, 8, 5, 0, 0, 2 * Math.PI);
        ctx.fill();
        ctx.beginPath();
        ctx.ellipse(centerX + 15, centerY - 5 + bounce, 6, 4, 0, 0, 2 * Math.PI);
        ctx.fill();
      }
      
      if (pet.energy < 30) {
        // 疲憊效果（Z字）
        ctx.fillStyle = '#fff';
        ctx.font = '16px Arial';
        ctx.fillText('Z', centerX + 30, centerY - 30 + bounce);
        ctx.fillText('z', centerX + 35, centerY - 15 + bounce);
      }
      
      animationFrame++;
    }
    
    // 更新屬性條
    function updateAttributes() {
      document.getElementById('hungerValue').textContent = pet.hunger;
      document.getElementById('hungerBar').style.width = pet.hunger + '%';
      
      document.getElementById('moodValue').textContent = pet.mood;
      document.getElementById('moodBar').style.width = pet.mood + '%';
      
      document.getElementById('energyValue').textContent = pet.energy;
      document.getElementById('energyBar').style.width = pet.energy + '%';
      
      document.getElementById('cleanValue').textContent = pet.clean;
      document.getElementById('cleanBar').style.width = pet.clean + '%';
      
      document.getElementById('healthValue').textContent = pet.health;
      document.getElementById('healthBar').style.width = pet.health + '%';
      
      document.getElementById('petName').textContent = pet.name;
      document.getElementById('petLevel').textContent = pet.level;
      document.getElementById('petExp').textContent = pet.exp;
      document.getElementById('petExpMax').textContent = pet.expMax;
    }
    
    // 寵物互動功能
    function feedPet() {
      if (pet.hunger >= 100) {
        addLog('🍎 寵物已經很飽了！', 'warning');
        return;
      }
      
      pet.hunger = Math.min(100, pet.hunger + 15);
      pet.mood = Math.min(100, pet.mood + 5);
      addLog('🍎 餵食成功！飢餓度 +15，心情 +5', 'success');
      updateAttributes();
    }
    
    function playWithPet() {
      if (pet.energy < 20) {
        addLog('🎾 寵物太累了，需要休息！', 'warning');
        return;
      }
      
      pet.mood = Math.min(100, pet.mood + 20);
      pet.energy = Math.max(0, pet.energy - 15);
      pet.hunger = Math.max(0, pet.hunger - 5);
      addLog('🎾 玩耍成功！心情 +20，活力 -15，飢餓度 -5', 'success');
      updateAttributes();
    }
    
    function bathePet() {
      pet.clean = Math.min(100, pet.clean + 25);
      pet.mood = Math.min(100, pet.mood + 10);
      addLog('🛁 洗澡成功！清潔度 +25，心情 +10', 'success');
      updateAttributes();
    }
    
    function sleepPet() {
      if (pet.energy >= 90) {
        addLog('😴 寵物還不累！', 'warning');
        return;
      }
      
      pet.energy = Math.min(100, pet.energy + 30);
      pet.health = Math.min(100, pet.health + 5);
      addLog('😴 哄睡成功！活力 +30，健康度 +5', 'success');
      updateAttributes();
    }
    
    function renamePet() {
      document.getElementById('newPetName').value = pet.name;
      document.getElementById('renameModal').classList.add('show');
    }
    
    function confirmRename() {
      const newName = document.getElementById('newPetName').value.trim();
      if (newName && newName.length <= 10) {
        pet.name = newName;
        addLog('✏️ 寵物名字已修改為：' + newName, 'success');
        updateAttributes();
        closeRenameModal();
      } else {
        alert('名字不能為空且不能超過10個字！');
      }
    }
    
    function closeRenameModal() {
      document.getElementById('renameModal').classList.remove('show');
    }
    
    function selectSkin(skin) {
      const costs = {
        'classic': 0,
        'red': 100,
        'blue': 150,
        'purple': 200
      };
      
      const cost = costs[skin];
      if (cost === 0 || confirm("確定要花費 " + cost + " 點數購買此皮膚嗎？")) {
        pet.skin = skin;
        addLog('🎨 已更換皮膚為：' + skin, 'success');
      }
    }
    
    function selectBackground(background) {
      const costs = {
        'grassland': 0,
        'sakura': 150,
        'starry': 200,
        'rainbow': 300
      };
      
      const cost = costs[background];
      if (cost === 0 || confirm("確定要花費 " + cost + " 點數購買此背景嗎？")) {
        pet.background = background;
        addLog('🖼️ 已更換背景為：' + background, 'success');
      }
    }
    
    function addLog(message, type = '') {
      const log = document.getElementById('petLog');
      const logItem = document.createElement('div');
      logItem.className = 'log-item' + (type ? ' ' + type : '');
      logItem.textContent = message;
      log.insertBefore(logItem, log.firstChild);
      
      // 限制日誌數量
      while (log.children.length > 10) {
        log.removeChild(log.lastChild);
      }
    }
    
    // 自動屬性下降
    function autoDecay() {
      pet.hunger = Math.max(0, pet.hunger - 1);
      pet.mood = Math.max(0, pet.mood - 0.5);
      pet.energy = Math.max(0, pet.energy - 0.8);
      pet.clean = Math.max(0, pet.clean - 0.3);
      
      // 健康度根據其他屬性計算
      const avgHealth = (pet.hunger + pet.mood + pet.energy + pet.clean) / 4;
      pet.health = Math.max(0, Math.min(100, avgHealth));
      
      updateAttributes();
    }
    
    // 初始化
    updateAttributes();
    drawPet();
    
    // 動畫循環
    setInterval(() => {
      drawPet();
    }, 100);
    
    // 每30秒自動下降屬性
    setInterval(autoDecay, 30000);
    
    // 點擊模態框外部關閉
    document.getElementById('renameModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeRenameModal();
      }
    });
      // 此功能待開發提醒函數
    function showComingSoon() {
      alert("此功能待開發");
    }
  </script>
</body>
</html>


<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>寵物系統 - GameSpace</title>
    <style>
        :root {
            --primary-color: #7557ff;
            --secondary-color: #34d2ff;
            --success-color: #22c55e;
            --text-primary: #1f2937;
            --text-secondary: #64748b;
            --bg-primary: #eef3f8;
            --bg-secondary: #ffffff;
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        body.dark {
            --text-primary: #e5edff;
            --text-secondary: #9fb1c9;
            --bg-primary: #0c111b;
            --bg-secondary: #0a0f18;
            --glass-bg: rgba(0, 0, 0, 0.25);
            --glass-border: rgba(255, 255, 255, 0.125);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.65;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
        }

        @media (min-width: 768px) {
            .container {
                padding: 0 24px;
            }
        }

        @media (min-width: 1024px) {
            .container {
                padding: 0 32px;
            }
        }

        /* Header */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
        }

        .nav {
            display: flex;
            gap: 24px;
        }

        .nav a {
            color: var(--text-primary);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav a:hover {
            background: var(--glass-bg);
            color: var(--primary-color);
        }

        .theme-toggle {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: #6b46e5;
            transform: translateY(-2px);
        }

        /* Main Content */
        .main-content {
            padding: 32px 0;
        }

        .page-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 36px;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 16px;
        }

        /* Pet Display */
        .pet-display {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .pet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .pet-name {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .pet-level {
            background: var(--success-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 600;
        }

        .pet-canvas-container {
            position: relative;
            display: inline-block;
            margin-bottom: 24px;
        }

        .pet-canvas {
            width: 200px;
            height: 200px;
            border-radius: 16px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border: 3px solid var(--glass-border);
            transition: all 0.3s ease;
        }

        .pet-canvas:hover {
            transform: scale(1.05);
            box-shadow: 0 16px 48px 0 rgba(31, 38, 135, 0.5);
        }

        .pet-experience {
            margin-top: 16px;
        }

        .exp-label {
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .exp-bar {
            width: 200px;
            height: 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            overflow: hidden;
            margin: 0 auto;
        }

        .exp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 6px;
            transition: width 0.3s ease;
        }

        .exp-text {
            margin-top: 8px;
            color: var(--text-primary);
            font-weight: 600;
        }

        /* Pet Stats */
        .pet-stats {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            box-shadow: var(--shadow);
        }

        .stats-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .stat-item {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px 0 rgba(31, 38, 135, 0.3);
        }

        .stat-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .stat-label {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-bar {
            margin-top: 8px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
        }

        .stat-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .hunger { background: linear-gradient(90deg, #ff6b6b, #ff8e8e); }
        .mood { background: linear-gradient(90deg, #4ecdc4, #6dd5ed); }
        .stamina { background: linear-gradient(90deg, #45b7d1, #96c7ed); }
        .cleanliness { background: linear-gradient(90deg, #96ceb4, #a8e6cf); }
        .health { background: linear-gradient(90deg, #feca57, #ff9ff3); }

        /* Pet Actions */
        .pet-actions {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            box-shadow: var(--shadow);
        }

        .actions-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
        }

        .action-btn {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            padding: 16px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
        }

        .action-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-4px);
            box-shadow: 0 8px 24px 0 rgba(117, 87, 255, 0.4);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Customization */
        .customization {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            box-shadow: var(--shadow);
        }

        .custom-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .custom-section {
            margin-bottom: 24px;
        }

        .custom-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .color-palette {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 12px;
        }

        .color-option {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.selected {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .color-option.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .color-option.locked::after {
            content: '🔒';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
        }

        .color-cost {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .background-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
        }

        .bg-option {
            width: 100px;
            height: 60px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .bg-option:hover {
            transform: scale(1.05);
        }

        .bg-option.selected {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .bg-option.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .bg-option.locked::after {
            content: '🔒';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 16px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .page-title {
                font-size: 28px;
            }
            
            .nav {
                display: none;
            }
            
            .pet-header {
                flex-direction: column;
                gap: 16px;
            }
            
            .pet-canvas {
                width: 150px;
                height: 150px;
            }
            
            .exp-bar {
                width: 150px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .pet-display,
        .pet-stats,
        .pet-actions,
        .customization {
            animation: fadeInUp 0.6s ease-out;
        }

        .pet-display { animation-delay: 0.1s; }
        .pet-stats { animation-delay: 0.2s; }
        .pet-actions { animation-delay: 0.3s; }
        .customization { animation-delay: 0.4s; }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .pet-canvas.bounce {
            animation: bounce 1s;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">🎮 GameSpace</a>
                <nav class="nav">
                    <a href="index.html">首頁</a>
                    <a href="wallet.html">會員錢包</a>
                    <a href="signin.html">每日簽到</a>
                    <a href="pet.html">寵物系統</a>
                    <a href="minigame.html">小遊戲</a>
                </nav>
                <button class="theme-toggle" onclick="toggleTheme()">🌙</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <div class="page-header">
                <h1 class="page-title">🐾 寵物系統</h1>
                <p class="page-subtitle">飼養可愛的史萊姆寵物，與牠互動、餵食、玩耍，見證牠的成長</p>
            </div>

            <!-- Pet Display -->
            <div class="pet-display">
                <div class="pet-header">
                    <h2 class="pet-name" id="petName">我的史萊姆</h2>
                    <span class="pet-level" id="petLevel">Lv.3</span>
                </div>
                <div class="pet-canvas-container">
                    <canvas class="pet-canvas" id="petCanvas" width="200" height="200"></canvas>
                </div>
                <div class="pet-experience">
                    <div class="exp-label">經驗值</div>
                    <div class="exp-bar">
                        <div class="exp-fill" id="expFill" style="width: 65%"></div>
                    </div>
                    <div class="exp-text" id="expText">130 / 200 XP</div>
                </div>
            </div>

            <!-- Pet Stats -->
            <div class="pet-stats">
                <h3 class="stats-title">寵物屬性</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-icon">🍎</div>
                        <div class="stat-label">飢餓</div>
                        <div class="stat-value" id="hungerValue">75%</div>
                        <div class="stat-bar">
                            <div class="stat-fill hunger" id="hungerBar" style="width: 75%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">😊</div>
                        <div class="stat-label">心情</div>
                        <div class="stat-value" id="moodValue">60%</div>
                        <div class="stat-bar">
                            <div class="stat-fill mood" id="moodBar" style="width: 60%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">⚡</div>
                        <div class="stat-label">體力</div>
                        <div class="stat-value" id="staminaValue">85%</div>
                        <div class="stat-bar">
                            <div class="stat-fill stamina" id="staminaBar" style="width: 85%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">🧼</div>
                        <div class="stat-label">清潔</div>
                        <div class="stat-value" id="cleanlinessValue">70%</div>
                        <div class="stat-bar">
                            <div class="stat-fill cleanliness" id="cleanlinessBar" style="width: 70%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">❤️</div>
                        <div class="stat-label">健康</div>
                        <div class="stat-value" id="healthValue">90%</div>
                        <div class="stat-bar">
                            <div class="stat-fill health" id="healthBar" style="width: 90%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pet Actions -->
            <div class="pet-actions">
                <h3 class="actions-title">寵物互動</h3>
                <div class="actions-grid">
                    <button class="action-btn" onclick="petAction('feed')">
                        🍎 餵食
                    </button>
                    <button class="action-btn" onclick="petAction('play')">
                        🎾 玩耍
                    </button>
                    <button class="action-btn" onclick="petAction('bath')">
                        🛁 洗澡
                    </button>
                    <button class="action-btn" onclick="petAction('sleep')">
                        😴 哄睡
                    </button>
                    <button class="action-btn" onclick="petAction('train')">
                        🏋️ 訓練
                    </button>
                    <button class="action-btn" onclick="petAction('heal')">
                        💊 治療
                    </button>
                </div>
            </div>

            <!-- Customization -->
            <div class="customization">
                <h3 class="custom-title">寵物外觀</h3>
                
                <div class="custom-section">
                    <div class="custom-section-title">膚色選擇</div>
                    <div class="color-palette">
                        <div class="color-option selected" style="background: #4ecdc4;" onclick="changeSkinColor('#4ecdc4', 0)"></div>
                        <div class="color-option" style="background: #ff6b6b;" onclick="changeSkinColor('#ff6b6b', 2000)">
                            <div class="color-cost">2000點</div>
                        </div>
                        <div class="color-option" style="background: #45b7d1;" onclick="changeSkinColor('#45b7d1', 2000)">
                            <div class="color-cost">2000點</div>
                        </div>
                        <div class="color-option" style="background: #96ceb4;" onclick="changeSkinColor('#96ceb4', 2000)">
                            <div class="color-cost">2000點</div>
                        </div>
                        <div class="color-option" style="background: #feca57;" onclick="changeSkinColor('#feca57', 2000)">
                            <div class="color-cost">2000點</div>
                        </div>
                        <div class="color-option locked" style="background: #ff9ff3;">
                            <div class="color-cost">5000點</div>
                        </div>
                        <div class="color-option locked" style="background: #a8e6cf;">
                            <div class="color-cost">5000點</div>
                        </div>
                        <div class="color-option locked" style="background: #ff8e8e;">
                            <div class="color-cost">5000點</div>
                        </div>
                    </div>
                </div>

                <div class="custom-section">
                    <div class="custom-section-title">背景主題</div>
                    <div class="background-options">
                        <div class="bg-option selected" style="background: linear-gradient(135deg, #ff6b6b, #4ecdc4);" onclick="changeBackground('gradient1', 0)">
                            彩虹
                        </div>
                        <div class="bg-option" style="background: linear-gradient(135deg, #45b7d1, #96c7ed);" onclick="changeBackground('gradient2', 0)">
                            海洋
                        </div>
                        <div class="bg-option" style="background: linear-gradient(135deg, #96ceb4, #a8e6cf);" onclick="changeBackground('gradient3', 0)">
                            森林
                        </div>
                        <div class="bg-option" style="background: linear-gradient(135deg, #feca57, #ff9ff3);" onclick="changeBackground('gradient4', 0)">
                            夕陽
                        </div>
                        <div class="bg-option locked" style="background: linear-gradient(135deg, #667eea, #764ba2);" onclick="changeBackground('gradient5', 1000)">
                            星空
                            <div class="color-cost">1000點</div>
                        </div>
                        <div class="bg-option locked" style="background: linear-gradient(135deg, #f093fb, #f5576c);" onclick="changeBackground('gradient6', 1000)">
                            櫻花
                            <div class="color-cost">1000點</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Theme toggle
        function toggleTheme() {
            document.body.classList.toggle('dark');
            const isDark = document.body.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            document.querySelector('.theme-toggle').textContent = isDark ? '☀️' : '🌙';
        }

        // Load saved theme
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark');
            document.querySelector('.theme-toggle').textContent = '☀️';
        }

        // Pet data
        let petData = {
            name: '我的史萊姆',
            level: 3,
            experience: 130,
            maxExperience: 200,
            hunger: 75,
            mood: 60,
            stamina: 85,
            cleanliness: 70,
            health: 90,
            skinColor: '#4ecdc4',
            background: 'gradient1'
        };

        // Pet drawing
        function drawPet() {
            const canvas = document.getElementById('petCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            const backgrounds = {
                'gradient1': ['#ff6b6b', '#4ecdc4'],
                'gradient2': ['#45b7d1', '#96c7ed'],
                'gradient3': ['#96ceb4', '#a8e6cf'],
                'gradient4': ['#feca57', '#ff9ff3'],
                'gradient5': ['#667eea', '#764ba2'],
                'gradient6': ['#f093fb', '#f5576c']
            };
            
            const bgColors = backgrounds[petData.background] || backgrounds['gradient1'];
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, bgColors[0]);
            gradient.addColorStop(1, bgColors[1]);
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw pet body (slime)
            ctx.fillStyle = petData.skinColor;
            ctx.beginPath();
            ctx.arc(100, 140, 60, 0, Math.PI * 2);
            ctx.fill();
            
            // Add shine effect
            const shineGradient = ctx.createRadialGradient(80, 120, 0, 80, 120, 30);
            shineGradient.addColorStop(0, 'rgba(255, 255, 255, 0.3)');
            shineGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
            ctx.fillStyle = shineGradient;
            ctx.beginPath();
            ctx.arc(80, 120, 30, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw eyes
            ctx.fillStyle = '#2c3e50';
            ctx.beginPath();
            ctx.arc(85, 125, 6, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(115, 125, 6, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw eye highlights
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(87, 123, 2, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(117, 123, 2, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw mouth based on mood
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 3;
            if (petData.mood > 70) {
                // Happy smile
                ctx.beginPath();
                ctx.arc(100, 145, 15, 0, Math.PI);
                ctx.stroke();
            } else if (petData.mood > 40) {
                // Neutral mouth
                ctx.beginPath();
                ctx.moveTo(90, 145);
                ctx.lineTo(110, 145);
                ctx.stroke();
            } else {
                // Sad mouth
                ctx.beginPath();
                ctx.arc(100, 155, 15, Math.PI, 0);
                ctx.stroke();
            }
            
            // Add sparkle effects
            ctx.fillStyle = '#ffd700';
            for (let i = 0; i < 5; i++) {
                const x = 20 + Math.random() * 160;
                const y = 20 + Math.random() * 160;
                ctx.beginPath();
                ctx.arc(x, y, 2, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Update pet stats display
        function updateStatsDisplay() {
            document.getElementById('hungerValue').textContent = petData.hunger + '%';
            document.getElementById('hungerBar').style.width = petData.hunger + '%';
            document.getElementById('moodValue').textContent = petData.mood + '%';
            document.getElementById('moodBar').style.width = petData.mood + '%';
            document.getElementById('staminaValue').textContent = petData.stamina + '%';
            document.getElementById('staminaBar').style.width = petData.stamina + '%';
            document.getElementById('cleanlinessValue').textContent = petData.cleanliness + '%';
            document.getElementById('cleanlinessBar').style.width = petData.cleanliness + '%';
            document.getElementById('healthValue').textContent = petData.health + '%';
            document.getElementById('healthBar').style.width = petData.health + '%';
            
            document.getElementById('expText').textContent = ${petData.experience} /  XP;
            document.getElementById('expFill').style.width = (petData.experience / petData.maxExperience * 100) + '%';
        }

        // Pet actions
        function petAction(action) {
            const actions = {
                'feed': { hunger: 20, mood: 10, stamina: -5, cleanliness: -5 },
                'play': { hunger: -10, mood: 15, stamina: -15, health: 5 },
                'bath': { cleanliness: 25, mood: 5, stamina: -5 },
                'sleep': { stamina: 20, health: 10, mood: 5, hunger: -5 },
                'train': { stamina: -10, mood: 5, health: 5, experience: 5 },
                'heal': { health: 20, stamina: 10, mood: 10 }
            };
            
            const effect = actions[action];
            if (!effect) return;
            
            // Update stats
            Object.keys(effect).forEach(stat => {
                if (stat === 'experience') {
                    petData[stat] = Math.min(petData.maxExperience, petData[stat] + effect[stat]);
                    // Check for level up
                    if (petData.experience >= petData.maxExperience) {
                        levelUp();
                    }
                } else {
                    petData[stat] = Math.max(0, Math.min(100, petData[stat] + effect[stat]));
                }
            });
            
            // Update display
            updateStatsDisplay();
            drawPet();
            
            // Show feedback
            const messages = {
                'feed': '史萊姆吃得很開心！',
                'play': '史萊姆玩得很興奮！',
                'bath': '史萊姆變得乾淨閃亮！',
                'sleep': '史萊姆睡得很香甜！',
                'train': '史萊姆變得更強壯了！',
                'heal': '史萊姆恢復了健康！'
            };
            
            alert(messages[action]);
            
            // Add bounce animation
            const canvas = document.getElementById('petCanvas');
            canvas.classList.add('bounce');
            setTimeout(() => {
                canvas.classList.remove('bounce');
            }, 1000);
        }

        // Level up function
        function levelUp() {
            petData.level++;
            petData.experience = 0;
            petData.maxExperience = Math.floor(petData.maxExperience * 1.5);
            
            // Increase all stats slightly
            petData.hunger = Math.min(100, petData.hunger + 10);
            petData.mood = Math.min(100, petData.mood + 10);
            petData.stamina = Math.min(100, petData.stamina + 10);
            petData.cleanliness = Math.min(100, petData.cleanliness + 10);
            petData.health = Math.min(100, petData.health + 10);
            
            document.getElementById('petLevel').textContent = Lv.;
            alert(恭喜！史萊姆升到 Lv.！所有屬性都提升了！);
            
            updateStatsDisplay();
        }

        // Change skin color
        function changeSkinColor(color, cost) {
            if (cost > 0) {
                if (confirm(確定要花費  點數更換膚色嗎？)) {
                    petData.skinColor = color;
                    drawPet();
                    
                    // Update selected color
                    document.querySelectorAll('.color-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    event.target.classList.add('selected');
                    
                    alert('膚色更換成功！');
                }
            } else {
                petData.skinColor = color;
                drawPet();
                
                // Update selected color
                document.querySelectorAll('.color-option').forEach(option => {
                    option.classList.remove('selected');
                });
                event.target.classList.add('selected');
            }
        }

        // Change background
        function changeBackground(bg, cost) {
            if (cost > 0) {
                if (confirm(確定要花費  點數更換背景嗎？)) {
                    petData.background = bg;
                    drawPet();
                    
                    // Update selected background
                    document.querySelectorAll('.bg-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    event.target.classList.add('selected');
                    
                    alert('背景更換成功！');
                }
            } else {
                petData.background = bg;
                drawPet();
                
                // Update selected background
                document.querySelectorAll('.bg-option').forEach(option => {
                    option.classList.remove('selected');
                });
                event.target.classList.add('selected');
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            drawPet();
            updateStatsDisplay();
            
            // Add periodic animations
            setInterval(() => {
                const canvas = document.getElementById('petCanvas');
                canvas.style.transform = 'translateY(-2px)';
                setTimeout(() => {
                    canvas.style.transform = 'translateY(0px)';
                }, 1000);
            }, 3000);
            
            // Simulate stat changes over time
            setInterval(() => {
                // Gradually decrease stats
                petData.hunger = Math.max(0, petData.hunger - 1);
                petData.mood = Math.max(0, petData.mood - 0.5);
                petData.stamina = Math.max(0, petData.stamina - 0.5);
                petData.cleanliness = Math.max(0, petData.cleanliness - 0.5);
                
                updateStatsDisplay();
            }, 30000); // Every 30 seconds
        });
    </script>
</body>
</html>
